import '../styles/style.sass'
import 'swiper/css'
import 'swiper/css/bundle'
import "aos/dist/aos.css"
import '@mantine/core/styles.css'
import '@mantine/dates/styles.css'

import type { AppProps } from 'next/app'
import React, { useContext, useEffect, useRef, useState } from 'react'

import Head from 'next/head'
import { BnovoContext, BnovoLoadContextProvider } from '../components/bnovo/bnovoContext'
import { useRouter } from 'next/router'
import LoadingBar, { LoadingBarRef } from 'react-top-loading-bar'
import AppLayout from '@/components/AppLayout'
import { YMProvider } from '@/components/ym/YMProvider'
import { createTheme, MantineProvider } from '@mantine/core'

const theme = createTheme({})

export default function App({ Component, pageProps }: AppProps) {
  const router = useRouter()

  const loaderRef = useRef<LoadingBarRef>(null)
  useEffect(() => {
    router.events.on('routeChangeStart', () => {
      loaderRef.current?.continuousStart()
    })

    router.events.on('routeChangeComplete', () => {
      loaderRef.current?.complete()
    })


  }, [router.asPath])


  return (
    <>
      <Head>
        {/* <title>Create Next App</title> */}
        {/* <meta name="description" content="Generated by create next app" /> */}
        <link rel="icon" href="/favicon.ico" />

      </Head>

      <LoadingBar color='#262626' ref={loaderRef} height={2} />

      <BnovoLoadContextProvider>
        <MantineProvider theme={theme}>
          <YMProvider counterId={94296197} options={{ trackLinks: true, clickmap: true, webVisor: true }}>
            <AppLayout asPath={router.asPath} pageProps={pageProps}>
              <Component {...pageProps} />
            </AppLayout>
          </YMProvider>
        </MantineProvider>
      </BnovoLoadContextProvider>
    </>
  )
}


